const n=12,sAndPHistoric=[43.81,-8.3,-25.12,-43.84,-8.64,49.98,-1.19,46.74,31.94,-35.34,29.28,-1.1,-10.67,-12.77,19.17,25.06,19.03,35.82,-8.43,5.2,5.7,18.3,30.81,23.68,18.15,-1.21,52.56,32.6,7.44,-10.46,43.72,12.06,.34,26.64,-8.81,22.61,16.42,12.4,-9.97,23.8,10.81,-8.24,3.56,14.22,18.76,-14.31,-25.9,37,23.83,-6.98,6.51,18.52,31.74,-4.7,20.42,22.34,6.15,31.24,18.49,5.81,16.54,31.48,-3.06,30.23,7.49,9.97,1.33,37.2,22.68,33.1,28.34,20.89,-9.03,-11.85,-21.97,28.36,10.74,4.83,15.61,5.48,-36.55,25.94,14.82,2.1,15.89,32.15,13.52,1.38,11.77,21.64].reverse(),currencySymbols={"en-US":"$","en-GB":"£"};let currencySymbol=currencySymbols[navigator.language]||"€",mainGraphCompoundData=null,mainGraphDepositsData=null,mainGraphCustomData=null,sAndPData=null,customData=null,sAndPDataOn=!0,noInterestDataOn=!0,customDataOn=!0,showCookieNotification=!0;function changeCurrency(e){currencySymbol=document.querySelector(".currency-selector").value,localStorage.setItem("currency-symbol",currencySymbol),document.querySelectorAll(".currency-symbol").forEach(function(e){e.innerText=currencySymbol})}function calc(){const e=Number(document.querySelector("input[name=principal]").value),t=Number(document.querySelector("input[name=rate]").value)/100,a=Number(document.querySelector("input[name=years]").value),o=Number(document.querySelector("input[name=monthlySum]").value);saveToLocalStorage(e,t,a,o);const r=runCompoundCalc(e,t,a,o);document.querySelector(".return .answer").innerText=Math.round(100*r)/100;const l=Math.round(100*(100*r/(e+o*n*a)-100))/100;document.querySelector(".interest-percent .answer").innerText=l>0?`+${l}`:l;const c=Math.round(o*n*a*100/e*100)/100;document.querySelector(".deposits-percent .answer").innerText=c>0?`+${c}`:c;const u=runNominalCalc(e,t,a,o),s=Math.round(100*(u-e-o*n*a))/100,i=Math.round(100*(r-e-o*n*a))/100;drawCompoundNominalGraph(i,s),drawInterestDepositsGraph(e+o*n*a,i),mainGraphCompoundData=buildCompoundData(e,t,a,o),mainGraphDepositsData=buildDepositsData(e,a,o),sAndPData=buildSAndPData(e,a,o);const d=document.querySelector(".custom-interest").value/100;mainGraphCustomData=buildCompoundData(e,d,a,o),drawMainGraph(),updateTable(calcTableValues(e,o,t,a<10?a+1:11))}function drawInterestDepositsGraph(e,t){document.getElementById("interest-deposits-graph").innerHTML='<canvas id="interest-deposits-chart"></canvas>';const n=document.getElementById("interest-deposits-chart").getContext("2d");new Chart(n,{type:"doughnut",data:{datasets:[{data:[t,e],backgroundColor:["rgb(252,75,26,0.6)","rgb(79,42,180,0.6)"]}],labels:["Interest","Deposits"]},options:{responsive:!0,maintainAspectRatio:!1,legend:{position:"left"},animation:{animateScale:!0,animateRotate:!0},tooltips:{caretSize:0,displayColors:!1}}})}function drawCompoundNominalGraph(e,t){document.getElementById("compound-nominal-graph").innerHTML='<canvas id="compound-nominal-chart"></canvas>';const n=document.getElementById("compound-nominal-chart").getContext("2d");new Chart(n,{type:"horizontalBar",data:{datasets:[{label:"Compound",backgroundColor:"rgb(111,220,202, 0.5)",borderColor:"rgb(0,0,0,0)",data:[e]},{label:"Nominal",backgroundColor:"rgb(247,184,51, 0.5)",borderColor:"rgb(0,0,0,0)",data:[t]}]},options:{responsive:!0,maintainAspectRatio:!1,legend:{position:"bottom",labels:{boxWidth:12}},scales:{xAxes:[{ticks:{beginAtZero:!0}}]},tooltips:{caretSize:0,displayColors:!1}}})}function drawMainGraph(){document.getElementById("main-graph").innerHTML='<canvas id="main-chart"></canvas>';const e=document.getElementById("main-chart").getContext("2d");e.height=500;const t=[{label:"Compound Interest",data:mainGraphCompoundData,backgroundColor:"rgb(111, 220, 202, 0.6)",borderColor:"rgb(111, 220, 202, 0.6)",radius:5,fill:!1}];sAndPDataOn&&t.push({label:"Historic S&P500",data:sAndPData,backgroundColor:"rgb(79, 42, 180, 0.6)",borderColor:"rgb(79, 42, 180, 0.6)",radius:5,fill:!1}),noInterestDataOn&&t.push({label:"No Interest",data:mainGraphDepositsData,backgroundColor:"rgb(247, 184, 51, 0.6)",borderColor:"rgb(247, 184, 51, 0.6)",radius:5,fill:!1}),customDataOn&&t.push({label:"Custom Interest",data:mainGraphCustomData,backgroundColor:"rgba(252, 75, 26, 0.6)",borderColor:"rgba(252, 75, 26,0.6)",radius:5,fill:!1}),new Chart(e,{type:"line",data:{labels:[...Array(mainGraphCompoundData.length).keys()],datasets:t},options:{responsive:!0,maintainAspectRatio:!1,tooltips:{position:"nearest",intersect:!1,caretSize:0,backgroundColor:"rgba(0,0,0,0)",titleFontColor:"rgba(0,0,0,0.5)",bodyFontColor:"rgba(0,0,0,0.8)",displayColors:!1,callbacks:{title:e=>`${e[0].xLabel} Year${"1"==e[0].xLabel?"":"s"}`,label:e=>`${currencySymbol}${e.yLabel}`}},scales:{xAxes:[{gridLines:{color:"rgba(0, 0, 0, 0)"},scaleLabel:{display:!0,labelString:"Years"}}]},elements:{point:{pointStyle:"circle"}}}})}function calcTableValues(e,t,a,o,r=[]){if(o<=0)return r;const l=r[r.length-1];if(void 0===l)return calcTableValues(e,t,a,o-1,[[e,0,e]]);const c=t*n,u=principalInterest(l[2],a,1)+monthly(t,a/n,n)-l[2]-c,s=l[0]+c;return r.push([s,u,l[2]+t*n+u]),calcTableValues(e,t,a,o-1,r)}function runCompoundCalc(e,t,a,o){return principalInterest(e,t,a)+monthly(o,t/n,a*n)}function principalInterest(e,t,a){return e*Math.pow(1+t/n,n*a)}function monthly(e,t,n){return 0===t?e*n:e*((Math.pow(1+t,n)-1)/t)*(1+t)}function runNominalCalc(e,t,a,o,r=e*t*a+e){return a<=0?r:runNominalCalc(e,t,a-1,o,r+o*n+t*o*12*a)}function saveToLocalStorage(e,t,n,a){localStorage.setItem("principal",e),localStorage.setItem("rate",100*t),localStorage.setItem("years",n),localStorage.setItem("monthlySum",a)}function buildCompoundData(e,t,n,a,o=[]){if(n<=0)return[e].concat(o.reverse());return buildCompoundData(e,t,n-1,a,o.concat(Math.round(100*runCompoundCalc(e,t,n,a))/100))}function buildDepositsData(e,t,a,o=[]){return t<=0?[e].concat(o.reverse()):buildDepositsData(e,t-1,a,o.concat(e+a*n*t))}function buildSAndPData(e,t,n,a=[e]){if(t<=0)return a;const o=sAndPHistoric[t%(sAndPHistoric.length-1)]/100,r=Math.round(100*runCompoundCalc(a[a.length-1],o,1,n))/100;return buildSAndPData(e,t-1,n,a.concat(r))}function toggleSAndP(e){sAndPDataOn=e.checked,localStorage.setItem("sAndPDataOn",sAndPDataOn),drawMainGraph()}function toggleNoInterest(e){noInterestDataOn=e.checked,localStorage.setItem("noInterestDataOn",noInterestDataOn),drawMainGraph()}function toggleCustomInterest(e){customDataOn=e.checked,localStorage.setItem("customDataOn",customDataOn),drawMainGraph()}function updateTable(e){const t=document.querySelector(".table .table-body"),n=e=>`<div class="cell">${Math.round(100*e)/100}</div>`,a=e.reduce((e,t,a)=>`${e}${(e=>`<div class="row">${e}</div>`)(`${n(a)}${n(t[0])}${n(t[1])}${n(t[2])}`)}`,"");t.innerHTML=a}window.calc=calc,window.changeCurrency=changeCurrency,window.toggleSAndP=toggleSAndP,window.toggleNoInterest=toggleNoInterest,window.toggleCustomInterest=toggleCustomInterest,function(){const e=localStorage.getItem("principal"),t=localStorage.getItem("rate"),n=localStorage.getItem("years"),a=localStorage.getItem("monthlySum");sAndPDataOn=null===localStorage.getItem("sAndPDataOn")||"false"!==localStorage.getItem("sAndPDataOn"),noInterestDataOn=null===localStorage.getItem("noInterestDataOn")||"false"!==localStorage.getItem("noInterestDataOn"),customDataOn=null===localStorage.getItem("customDataOn")||"false"!==localStorage.getItem("customDataOn"),showCookieNotification=null===localStorage.getItem("showCookieNotification")||"false"!==localStorage.getItem("showCookieNotification"),null!==e&&(document.querySelector("input[name=principal]").value=e),null!==t&&(document.querySelector("input[name=rate]").value=t),null!==n&&(document.querySelector("input[name=years]").value=n),null!==a&&(document.querySelector("input[name=monthlySum]").value=a)}(),document.querySelector('[type="checkbox"].s-and-p').checked=sAndPDataOn,document.querySelector('[type="checkbox"].no-interest').checked=noInterestDataOn,document.querySelector('[type="checkbox"].custom').checked=customDataOn,currencySymbol=localStorage.getItem("currency-symbol")||currencySymbol,document.querySelectorAll(".currency-symbol").forEach(function(e){e.innerText=currencySymbol}),document.querySelector(".currency-selector").value=currencySymbol,calc(),document.querySelector("input[name=years").addEventListener("input",function(){this.value>999&&(this.value=999)});
